   <style>
  .header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
  }
  .weight-section {
    display: flex;
    align-items: baseline;
    gap: 6px;
  }
  .chart-container {
    width: 100%;
    height: 140px;
  }
  .charts-wrapper {
    display: flex;
    flex-direction: column;
    gap: 4px;
    width: 100%;
  }
</style>

<div class="view">
  <div class="layout layout--col layout--top gap--xsmall">

    <!-- Header: Cat name + Weight -->
    <div class="header-row">
      <span class="title">{{ cat_name }}</span>
      <div class="weight-section">
        <span class="value value--large value--tnums">{{ weight.average }}</span>
        <span class="label label--small">lbs</span>
        {% if weight.trend == "gaining" %}
          <span class="label label--small label--outline">↑ {{ weight.change | abs }}</span>
        {% elsif weight.trend == "losing" %}
          <span class="label label--small label--outline">↓ {{ weight.change | abs }}</span>
        {% else %}
          <span class="label label--small label--outline">→ stable</span>
        {% endif %}
      </div>
    </div>

    <!-- Charts -->
    <div class="flex flex--col charts-wrapper">
      <div class="charts-wrapper">
        <span class="label label--small label--underline">Visits per day</span>
        <div id="visits-chart" class="chart-container"></div>
      </div>
      <div class="charts-wrapper">
        <span class="label label--small label--underline">Weight (lbs)</span>
        <div id="weight-chart" class="chart-container"></div>
      </div>
    </div>
  </div>

  <!-- Title bar -->
  <div class="title_bar">
    <span class="title">{{ date_range.display }}</span>
    <span class="instance">{{ robot_name }} </span>
  </div>
</div>

<script src="https://usetrmnl.com/js/highcharts/12.3.0/highcharts.js"></script>
<script src="https://usetrmnl.com/js/chartkick/5.0.1/chartkick.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  var chartOptions = {
    adapter: "highcharts",
    colors: ["#000000"],
    library: {
      chart: {
        animation: false,
        backgroundColor: 'transparent',
        style: { fontFamily: 'inherit' },
        spacing: [5, 0, 5, 0]
      },
      title: { text: null },
      legend: { enabled: false },
      xAxis: {
        lineColor: '#000',
        tickColor: '#000',
        labels: { style: { color: '#000', fontSize: '9px' } }
      },
      yAxis: {
        title: { text: null },
        gridLineColor: '#ccc',
        gridLineDashStyle: 'Dash',
        labels: { style: { color: '#000', fontSize: '9px' } }
      },
      plotOptions: {
        series: { animation: false, enableMouseTracking: false }
      },
      credits: { enabled: false },
      tooltip: { enabled: false }
    }
  };

  // Visits chart - data embedded via Liquid
  var visitsData = [
    {% for day in chart_data %}
      ["{{ day.display }}", {{ day.count }}]{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ];

  new Chartkick.ColumnChart("visits-chart", visitsData, {
    adapter: chartOptions.adapter,
    colors: chartOptions.colors,
    library: Object.assign({}, chartOptions.library, {
      yAxis: Object.assign({}, chartOptions.library.yAxis, { allowDecimals: false }),
      plotOptions: Object.assign({}, chartOptions.library.plotOptions, {
        column: { borderColor: '#000', borderWidth: 1 }
      })
    })
  });

  // Weight chart - data embedded via Liquid
  var weightData = [
    {% for day in weight_history %}
      ["{{ day.display }}", {{ day.weight }}]{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ];

  if (weightData.length > 0) {
    new Chartkick.LineChart("weight-chart", weightData, {
      adapter: chartOptions.adapter,
      colors: chartOptions.colors,
      library: Object.assign({}, chartOptions.library, {
        yAxis: Object.assign({}, chartOptions.library.yAxis, {
          min: {{ weight.min | minus: 0.5 }},
          max: {{ weight.max | plus: 0.5 }}
        }),
        plotOptions: Object.assign({}, chartOptions.library.plotOptions, {
          line: {
            marker: { enabled: true, radius: 3, fillColor: '#000' },
            lineWidth: 2
          }
        })
      })
    });
  }
});
</script>
